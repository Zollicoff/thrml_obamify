Metadata-Version: 2.4
Name: thrml-obamify
Version: 0.1.0
Summary: Energy-based image palette stylization in the spirit of 'Obamify', implemented with thrml + JAX.
Author: thrml-Obamify contributors
License: MIT
Keywords: jax,thrml,energy-based,image stylization,palette
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3 :: Only
Classifier: Programming Language :: Python :: 3.11
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Requires-Python: >=3.11
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: thrml==0.1.3
Requires-Dist: numpy==2.1.3
Requires-Dist: Pillow==10.4.0
Requires-Dist: matplotlib==3.9.2
Requires-Dist: imageio==2.36.0
Requires-Dist: tqdm==4.66.5
Provides-Extra: cpu
Requires-Dist: jax==0.4.33; extra == "cpu"
Requires-Dist: jaxlib==0.4.33; extra == "cpu"
Provides-Extra: metal
Requires-Dist: jax>=0.4.33; extra == "metal"
Requires-Dist: jax-metal>=0.0.8; extra == "metal"
Dynamic: license-file

# thrml-Obamify

**thrml-Obamify** is an experimental image transformation that uses [Extropic’s ](https://github.com/extropic-ai/thrml)[`thrml`](https://github.com/extropic-ai/thrml) to recreate any input image in the style of Barack Obama. Instead of neural nets or classical filters, it uses an energy-based sampling process that “cools” an image toward an Obama-like equilibrium.

---

## How it works

Each pixel (or small block) in the output is a discrete variable that selects from a palette or tile dictionary derived from an Obama reference image.

An energy function balances three terms:

* **Content**: stay similar to the source image in color or local patches.
* **Style**: prefer colors/patterns present in the Obama reference.
* **Smoothness**: encourage neighboring pixels to agree where it helps preserve contours.

Sampling (blocked Gibbs with an annealing schedule) gradually lowers the temperature. The configuration settles into a low-energy, Obama-styled image.

---

## Quick start

### 1) Create an environment

macOS (Metal / Apple Silicon):

```bash
conda env create -f environment-macos-metal.yml
conda activate thrml-obamify
pre-commit install
```

Windows (CPU for development only):

```bash
conda env create -f environment-windows-cpu.yml
conda activate thrml-obamify
pre-commit install
```

### 2) Run the CLI

```bash
obamify \
  --source assets/your_image.jpg \
  --target assets/obama.jpg \
  --steps 500 \
  --palette_size 24 \
  --save_gif
```

### 3) Outputs

```
output/
  obamified.png   # final image
  progress.gif    # optional animation of the cooling process
```

---

## Parameters

| Flag              | Description                                  | Default |
| ----------------- | -------------------------------------------- | ------- |
| `--steps`         | Number of sampling steps                     | 500     |
| `--beta_start`    | Starting inverse temperature                 | 0.1     |
| `--beta_end`      | Final inverse temperature                    | 2.0     |
| `--palette_size`  | Number of colors taken from the target image | 24      |
| `--alpha`         | Weight on content vs style (0..1)            | 0.5     |
| `--lambda_smooth` | Smoothness weight for neighbors              | 0.8     |

---

## Notes

* Start small (e.g., 128×128) to get quick feedback.
* Try grayscale first, then color palettes of 16–32 colors.
* Save intermediate frames to see the cooling process.

---

## Roadmap

*

---

## Acknowledgments

* [`thrml`](https://github.com/extropic-ai/thrml) for discrete sampling utilities
* [Original Obamify](https://github.com/Spu7Nix/obamify) for the meme inspiration

---

## License

MIT. Credit `thrml` and the original `Obamify` projects.
